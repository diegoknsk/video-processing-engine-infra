---
alwaysApply: false
description: "Guia universal para cria√ß√£o de hist√≥rias t√©cnicas ‚Äî evolu√ß√£o da especifica√ß√£o, estimativas robustas, an√°lise detalhada e desenvolvimento assertivo."
---

# Cria√ß√£o de Hist√≥rias T√©cnicas ‚Äî Guia Universal

## Objetivo

Este documento define o padr√£o para **cria√ß√£o de hist√≥rias t√©cnicas** reutiliz√°vel em qualquer projeto. As hist√≥rias s√£o tratadas como **evolu√ß√£o da especifica√ß√£o t√©cnica**: refinam requisitos, habilitam **estimativas mais robustas**, **an√°lise extremamente detalhada** e **desenvolvimento mais assertivo**. Unifica vis√£o de arquitetura e de desenvolvedores seniores para qualidade e rastreabilidade.

---

## 1. Hist√≥rias como Evolu√ß√£o da Especifica√ß√£o T√©cnica

### 1.1 Papel das Hist√≥rias

- As hist√≥rias **derivam e refinam** a especifica√ß√£o t√©cnica (documento de requisitos, contrato de API, decis√µes de arquitetura).
- Cada hist√≥ria deve ser **detalhada o suficiente** para:
  - **Estimativa:** permitir estimativas por subtask (esfor√ßo, depend√™ncias, riscos).
  - **An√°lise:** cobrir cen√°rios, edge cases, invariantes e contratos (API, dom√≠nio).
  - **Desenvolvimento:** guiar implementa√ß√£o passo a passo, com crit√©rios de aceite test√°veis e rastre√°veis.

### 1.2 Ciclo Especifica√ß√£o ‚Üí Hist√≥ria ‚Üí Desenvolvimento

```
Especifica√ß√£o t√©cnica (requisitos, contrato, arquitetura)
  ‚Üí Refinamento em hist√≥rias (escopo, subtasks, crit√©rios de aceite)
  ‚Üí Estimativa por hist√≥ria/subtask (esfor√ßo, depend√™ncias, riscos)
  ‚Üí An√°lise detalhada (edge cases, valida√ß√µes, testes)
  ‚Üí Desenvolvimento assertivo (seguir subtasks, validar crit√©rios, testes)
```

### 1.3 Regra Cr√≠tica: Separa√ß√£o Cria√ß√£o vs. Desenvolvimento

- **Quando o usu√°rio pedir para criar uma story:**  
  - ‚úÖ **Apenas criar** a story (arquivo `story.md` e subtasks).  
  - ‚ùå **N√£o desenvolver/implementar** em seguida.  
  - ‚ùå **N√£o executar** subtasks automaticamente.  
  - ‚è∏Ô∏è **Aguardar** solicita√ß√£o expl√≠cita para desenvolver.

- **Quando o usu√°rio pedir para desenvolver/implementar:**  
  - ‚úÖ **A√≠ sim** executar o desenvolvimento seguindo as subtasks.  
  - ‚úÖ Seguir a ordem das subtasks.  
  - ‚úÖ Atualizar status da story conforme o progresso.

- **Regra de conclus√£o:** Quando o usu√°rio solicitar o commit das mudan√ßas de uma hist√≥ria, a story deve ser marcada como **‚úÖ Conclu√≠da** com a **data de conclus√£o** preenchida (DD/MM/AAAA).

---

## 2. Estrutura de Pastas e Nomenclatura

### 2.1 Nomenclatura da Pasta da Hist√≥ria

**Formato obrigat√≥rio:**

```
Storie-XX-Descricao_Breve_Da_Historia
```

**Regras:**

- Prefixo `Storie-` + n√∫mero com **2 d√≠gitos** (01, 02, 03‚Ä¶), sequencial e √∫nico.
- Descri√ß√£o **curta** (m√°ximo 5‚Äì6 palavras), com **underscore** (`_`) entre palavras.
- Descri√ß√£o **clara**: permitir identificar o conte√∫do pelo nome da pasta.
- Primeira letra de cada palavra em mai√∫scula (PascalCase por palavra, separa√ß√£o por underscore).

**Exemplos corretos:**

- `Storie-01-Implementar_Autenticacao_Usuario`
- `Storie-05-Criar_API_Endpoints_Produto`
- `Storie-12-Integracao_Sistema_Pagamento`
- `Storie-15-Refatoracao_Camada_Application`

**Exemplos incorretos:**

- `Storie-1-Backend` (n√∫mero sem zero √† esquerda)
- `Storie-01-backend-api` (h√≠fen em vez de underscore)
- `Storie-01-BackendAPI` (sem separa√ß√£o, dif√≠cil de ler)

### 2.2 Estrutura Interna da Pasta

```
Storie-XX-Descricao/
‚îú‚îÄ‚îÄ story.md              # Arquivo principal da hist√≥ria
‚îî‚îÄ‚îÄ subtask/              # Pasta com todas as subtasks
    ‚îú‚îÄ‚îÄ Subtask-01-Nome.md
    ‚îú‚îÄ‚îÄ Subtask-02-Nome.md
    ‚îî‚îÄ‚îÄ Subtask-03-Nome.md
```

**Regras:**

- Sempre um arquivo `story.md` na raiz da pasta da hist√≥ria.
- Sempre uma pasta `subtask/` (pode estar vazia no in√≠cio).
- Nenhum outro arquivo na raiz da pasta da hist√≥ria.

---

## 3. Formato do Arquivo story.md

### 3.1 Estrutura Obrigat√≥ria

```markdown
# Storie-XX: T√≠tulo da Hist√≥ria

## Status
- **Estado:** üîÑ Em desenvolvimento | ‚úÖ Conclu√≠da | ‚è∏Ô∏è Pausada
- **Data de Conclus√£o:** [DD/MM/AAAA] (preencher quando conclu√≠da)

## Descri√ß√£o
Como [papel], quero [a√ß√£o], para [benef√≠cio].

## Objetivo
[Descri√ß√£o clara e objetiva do que ser√° entregue]

## Escopo T√©cnico
- Tecnologias: [Lista de tecnologias e vers√µes]
- Arquivos afetados: [Lista de arquivos/caminhos]
- Componentes/Recursos: [Componentes, m√≥dulos ou recursos criados/modificados]
- Pacotes/Depend√™ncias: [Nome e vers√£o de cada pacote externo]

## Depend√™ncias e Riscos (para estimativa)
- Depend√™ncias: [Outras stories, APIs, servi√ßos]
- Riscos/Pr√©-condi√ß√µes: [Riscos t√©cnicos ou de neg√≥cio; pr√©-condi√ß√µes]

## Subtasks
- [Subtask 01: Nome](./subtask/Subtask-01-Nome.md)
- [Subtask 02: Nome](./subtask/Subtask-02-Nome.md)
- [Subtask 03: Nome](./subtask/Subtask-03-Nome.md)

## Crit√©rios de Aceite da Hist√≥ria
- [ ] Crit√©rio 1 (espec√≠fico e mensur√°vel)
- [ ] Crit√©rio 2 (espec√≠fico e mensur√°vel)
- [ ] ...
```

### 3.2 Regras de Escrita do story.md

1. **Status**  
   - Obrigat√≥rio. Estados: üîÑ Em desenvolvimento | ‚úÖ Conclu√≠da | ‚è∏Ô∏è Pausada.  
   - Ao concluir: estado "‚úÖ Conclu√≠da" e data de conclus√£o (DD/MM/AAAA).  
   - Atualizar sempre que o status mudar.

2. **T√≠tulo**  
   - Formato: `# Storie-XX: T√≠tulo da Hist√≥ria`.  
   - Claro e descritivo; m√°ximo ~10 palavras.

3. **Descri√ß√£o**  
   - Formato "Como [papel], quero [a√ß√£o], para [benef√≠cio]".  
   - Papel espec√≠fico (ex.: desenvolvedor, usu√°rio final, administrador).  
   - A√ß√£o clara; benef√≠cio mensur√°vel ou observ√°vel.

4. **Objetivo**  
   - Uma frase ou par√°grafo curto.  
   - Explicar **O QUE** ser√° entregue, n√£o **COMO**.  
   - Foco no resultado final.

5. **Escopo T√©cnico**  
   - Tecnologias com vers√µes quando relevante.  
   - Arquivos/caminhos criados ou modificados.  
   - Componentes, m√≥dulos ou recursos afetados.  
   - **Obrigat√≥rio:** listar **todos os pacotes/depend√™ncias externas** (NuGet, npm, pip, etc.) com **nome e vers√£o** para revis√£o antes da finaliza√ß√£o.  
   - Ser espec√≠fico, n√£o gen√©rico.

6. **Depend√™ncias e Riscos (para estimativa)**  
   - Outras stories, APIs ou servi√ßos dos quais esta hist√≥ria depende.  
   - Riscos t√©cnicos ou de neg√≥cio; pr√©-condi√ß√µes.  
   - Facilita estimativa e planejamento.

7. **Subtasks**  
   - M√≠nimo 3, m√°ximo 8.  
   - Cada uma: a√ß√£o espec√≠fica e test√°vel; ordem l√≥gica (depend√™ncias).  
   - Links relativos: `./subtask/Subtask-XX-Nome.md`.

8. **Crit√©rios de Aceite**  
   - M√≠nimo 5 crit√©rios; ideal 7‚Äì10.  
   - Cada crit√©rio: **espec√≠fico**, **mensur√°vel** e **test√°vel**.  
   - Formato checklist: `- [ ]`.  
   - Incluir: funcionalidade, qualidade (valida√ß√µes, testes), documenta√ß√£o (se aplic√°vel).  
   - **Obrigat√≥rio para stories com c√≥digo:** crit√©rios de aceite relacionados a **testes unit√°rios** (e cobertura quando aplic√°vel).

---

## 4. Requisitos Obrigat√≥rios

### 4.1 Testes Unit√°rios

- **Regra:** Todas as stories que **criam ou modificam c√≥digo** devem incluir testes unit√°rios.
- Incluir: subtask(s) para testes e crit√©rios de aceite que validem testes (ex.: "Testes unit√°rios criados e passando", "Cobertura m√≠nima de 80%").
- **Exce√ß√µes:** stories apenas de configura√ß√£o, documenta√ß√£o ou reorganiza√ß√£o de estrutura sem l√≥gica de neg√≥cio.

### 4.2 Registro de Pacotes/Depend√™ncias

- **Regra:** Todos os pacotes externos (NuGet, npm, pip, etc.) adicionados ao projeto devem ser **registrados na story** (Escopo T√©cnico ou se√ß√£o "Pacotes/Depend√™ncias") com **nome e vers√£o**, para revis√£o antes da finaliza√ß√£o.
- Benef√≠cios: revis√£o de depend√™ncias, controle de vers√µes, compatibilidade e identifica√ß√£o de vulnerabilidades.

---

## 5. An√°lise Detalhada para Desenvolvimento Assertivo

### 5.1 O que a Hist√≥ria Deve Permitir Analisar

Para **estimativas robustas** e **desenvolvimento assertivo**, cada hist√≥ria (e subtask) deve permitir:

- **Contratos:** entrada/sa√≠da de APIs, DTOs, valida√ß√µes (ex.: FluentValidation).
- **Invariantes de dom√≠nio:** regras que sempre devem ser verdadeiras (entidades, value objects).
- **Edge cases:** cen√°rios de borda (valores nulos, listas vazias, limites, erros de integra√ß√£o).
- **Depend√™ncias:** ordem de implementa√ß√£o, impacto em outras camadas ou servi√ßos.
- **Riscos:** integra√ß√µes externas, mudan√ßas de contrato, performance.

### 5.2 N√≠vel de Detalhe nas Subtasks

- Cada subtask deve ser **analis√°vel** antes do desenvolvimento: escopo claro, passos de implementa√ß√£o, formas de teste e crit√©rios de aceite.
- Se uma subtask for grande demais para estimar ou implementar com seguran√ßa, **quebrar em subtasks menores**.
- Incluir, quando fizer sentido:
  - Contratos (ex.: "InputModel X com propriedades A, B; valida√ß√£o Y").
  - Cen√°rios de teste esperados (sucesso, valida√ß√£o, erro externo).
  - Refer√™ncia a arquivos ou componentes afetados.

### 5.3 Crit√©rios de Aceite: Espec√≠ficos e Mensur√°veis

- Evitar crit√©rios vagos ("c√≥digo funciona", "est√° correto").  
- Preferir crit√©rios **execut√°veis** (ex.: "Executar `dotnet test` e verificar que todos passam", "Cobertura ‚â• 80%", "Endpoint retorna 400 quando InputModel inv√°lido").

---

## 6. Princ√≠pios de Qualidade

### 6.1 Simplicidade das Subtasks

- Cada subtask deve ser:
  - Implement√°vel em **1‚Äì2 horas** (ideal).
  - **Test√°vel** de forma independente.
  - Com **crit√©rios de aceite** claros e objetivos.
  - Valid√°vel sem depender de outras subtasks, quando poss√≠vel.
- Se uma subtask fizer "muitas coisas ao mesmo tempo", **quebrar em v√°rias subtasks**.

### 6.2 Consist√™ncia

- **Nomenclatura:** seguir o padr√£o (Storie-XX, Subtask-XX, underscore na descri√ß√£o).
- **Formato:** usar sempre a estrutura obrigat√≥ria do `story.md` e do template de subtask.
- **Linguagem:** portugu√™s brasileiro; claro e objetivo; termos t√©cnicos quando apropriado.

### 6.3 Rastreabilidade

- **Links:** sempre relativos; formato `./subtask/Subtask-XX-Nome.md`.
- **Refer√™ncias:** a outras hist√≥rias ou arquivos do projeto usando caminhos relativos (ex.: `src/Application/UseCases/User/CreateUserUseCase.cs`).

---

## 7. Formato das Subtasks

Cada arquivo de subtask deve conter:

- **Descri√ß√£o** clara do que ser√° feito.
- **Passos de implementa√ß√£o** (m√≠nimo 3): ordem l√≥gica e verific√°vel.
- **Formas de teste** (m√≠nimo 3): como validar (testes unit√°rios, manual, integra√ß√£o).
- **Crit√©rios de aceite da subtask** (m√≠nimo 3): espec√≠ficos e mensur√°veis.
- Se envolve c√≥digo: **incluir cria√ß√£o/atualiza√ß√£o de testes unit√°rios** nos passos ou nos crit√©rios.

---

## 8. Checklist de Cria√ß√£o de Hist√≥ria

Antes de considerar uma hist√≥ria completa:

### Estrutura

- [ ] Pasta no formato `Storie-XX-Descricao_Breve`
- [ ] Arquivo `story.md` na raiz da pasta
- [ ] Pasta `subtask/` criada
- [ ] Todas as subtasks criadas em `subtask/`

### Conte√∫do do story.md

- [ ] Status preenchido (estado e data de conclus√£o quando aplic√°vel)
- [ ] T√≠tulo no formato correto
- [ ] Descri√ß√£o no formato "Como... quero... para..."
- [ ] Objetivo claro
- [ ] Escopo t√©cnico completo (tecnologias, arquivos, componentes)
- [ ] **Todos os pacotes/depend√™ncias externas registrados com nome e vers√£o**
- [ ] Depend√™ncias e riscos descritos (para estimativa)
- [ ] M√≠nimo 3 subtasks listadas; links funcionando
- [ ] M√≠nimo 5 crit√©rios de aceite; todos espec√≠ficos e mensur√°veis
- [ ] **Se envolve c√≥digo: crit√©rios de aceite incluem testes unit√°rios**

### Conte√∫do das Subtasks

- [ ] Descri√ß√£o clara; m√≠nimo 3 passos de implementa√ß√£o
- [ ] M√≠nimo 3 formas de teste; m√≠nimo 3 crit√©rios de aceite por subtask
- [ ] Subtasks simples e test√°veis individualmente; ordem l√≥gica
- [ ] **Se envolve c√≥digo: subtasks incluem cria√ß√£o/atualiza√ß√£o de testes unit√°rios**

### Qualidade

- [ ] Nomenclatura e formata√ß√£o consistentes
- [ ] Sem erros de ortografia; linguagem clara; termos t√©cnicos corretos

---

## 9. Exemplo Resumido (story.md)

```markdown
# Storie-05: Implementar Autentica√ß√£o de Usu√°rio

## Status
- **Estado:** üîÑ Em desenvolvimento
- **Data de Conclus√£o:** [DD/MM/AAAA]

## Descri√ß√£o
Como usu√°rio do sistema, quero fazer login com email e senha, para acessar funcionalidades restritas da aplica√ß√£o.

## Objetivo
Implementar fluxo completo de autentica√ß√£o: endpoint de login, valida√ß√£o de credenciais, emiss√£o de token e prote√ß√£o de rotas que exigem autentica√ß√£o.

## Escopo T√©cnico
- Tecnologias: .NET 8, ASP.NET Core, JWT
- Arquivos afetados: `src/Api/Controllers/AuthController.cs`, `src/Application/UseCases/Auth/`, `src/Infra/Services/TokenService.cs`
- Componentes: AuthController, LoginUseCase, ITokenService, RequireAuth filter
- Pacotes/Depend√™ncias:
  - Microsoft.AspNetCore.Authentication.JwtBearer (8.0.0)
  - System.IdentityModel.Tokens.Jwt (7.0.0)

## Depend√™ncias e Riscos (para estimativa)
- Depend√™ncias: Nenhuma outra story; depende de especifica√ß√£o do contrato de login (request/response).
- Riscos: Nenhum cr√≠tico; pr√©-condi√ß√£o: contrato de API definido.

## Subtasks
- [Subtask 01: Criar InputModel e validator de login](./subtask/Subtask-01-InputModel_Validator_Login.md)
- [Subtask 02: Implementar UseCase e integra√ß√£o com servi√ßo de token](./subtask/Subtask-02-UseCase_Login.md)
- [Subtask 03: Criar endpoint e filter de autentica√ß√£o](./subtask/Subtask-03-Endpoint_Filter_Auth.md)
- [Subtask 04: Testes unit√°rios e crit√©rios de aceite](./subtask/Subtask-04-Testes_Unitarios_Auth.md)

## Crit√©rios de Aceite da Hist√≥ria
- [ ] Endpoint POST /auth/login aceita email e senha e retorna token JWT
- [ ] Valida√ß√£o de input (FluentValidation) retorna 400 com mensagens claras quando inv√°lido
- [ ] Token JWT cont√©m claims esperados (sub, exp, etc.)
- [ ] Rotas protegidas retornam 401 sem token v√°lido
- [ ] Testes unit√°rios cobrindo UseCase, Validator e Controller; cobertura m√≠nima 80%
- [ ] Documenta√ß√£o Swagger atualizada para o endpoint de login
- [ ] Tratamento de erro para credenciais inv√°lidas (401) e servidor indispon√≠vel (503)
```

---

## 10. Erros Comuns a Evitar

1. **Subtasks muito complexas:** quebrar em v√°rias (ex.: "Implementar autentica√ß√£o completa" ‚Üí InputModel/Validator, UseCase, Endpoint/Filter, Testes).
2. **Crit√©rios de aceite vagos:** preferir "Testes unit√°rios passam com cobertura ‚â• 80%" em vez de "C√≥digo funciona".
3. **Falta de testabilidade:** incluir formas concretas de teste (comando, cen√°rios, resultados esperados).
4. **Nomenclatura inconsistente:** usar sempre `Storie-XX-Descricao_Com_Underscore` e `Subtask-XX-Nome`.
5. **Links quebrados:** usar caminho relativo correto `./subtask/Subtask-XX-Nome.md`.
6. **Escopo t√©cnico gen√©rico:** listar tecnologias e vers√µes, arquivos e pacotes com nome e vers√£o.
7. **Hist√≥ria sem foco em especifica√ß√£o:** garantir que contratos, edge cases e depend√™ncias estejam refletidos no escopo e nas subtasks para estimativa e desenvolvimento assertivo.

---

## 11. Refer√™ncias

- Hist√≥rias existentes no reposit√≥rio servem como exemplos.
- Manter consist√™ncia com padr√µes j√° estabelecidos.
- Alinhar com o guia de arquitetura e o guia de desenvolvimento do projeto quando existirem.

---

## Valida√ß√£o por Tr√™s Perspectivas

### Revisor 1 ‚Äî Arquiteto (Especifica√ß√£o e Estimativa)

**Aprova√ß√£o:** ‚úÖ Documento adequado para evolu√ß√£o da especifica√ß√£o e estimativas.

**Pontos fortes:** Hist√≥rias tratadas como refinamento da especifica√ß√£o; se√ß√£o "Depend√™ncias e Riscos" favorece estimativa; escopo t√©cnico com pacotes e vers√µes permite revis√£o de depend√™ncias; crit√©rios de aceite acion√°veis melhoram a previsibilidade.

**Sugest√£o:** Em projetos com contrato de API formal (OpenAPI), considerar referenciar o contrato na story (ex.: "Conforme spec OpenAPI v1.2 - /auth/login").

**Conclus√£o:** Recomendado como guia para cria√ß√£o de hist√≥rias que evoluem a especifica√ß√£o e suportam estimativas robustas.

---

### Revisor 2 ‚Äî Desenvolvedor S√™nior (An√°lise e Desenvolvimento Assertivo)

**Aprova√ß√£o:** ‚úÖ Utiliz√°vel no dia a dia para an√°lise detalhada e implementa√ß√£o.

**Pontos fortes:** √änfase em contratos, invariantes e edge cases torna a an√°lise antes do desenvolvimento mais eficaz; subtasks com passos e formas de teste reduzem ambiguidade; crit√©rios de aceite mensur√°veis e obrigatoriedade de testes unit√°rios aumentam a assertividade do desenvolvimento; checklist evita hist√≥rias incompletas.

**Sugest√£o:** Manter exemplos de crit√©rios "execut√°veis" (comandos, cobertura, c√≥digos HTTP) para replicar em novas stories.

**Conclus√£o:** Aprovado para uso como padr√£o de cria√ß√£o de hist√≥rias com foco em desenvolvimento assertivo.

---

### Revisor 3 ‚Äî L√≠der T√©cnico (Rastreabilidade e Qualidade)

**Aprova√ß√£o:** ‚úÖ Alinhado a rastreabilidade e qualidade.

**Pontos fortes:** Separa√ß√£o expl√≠cita entre "criar story" e "desenvolver" evita execu√ß√£o prematura; regra de marcar story como conclu√≠da com data ao solicitar commit mant√©m rastreabilidade; registro de pacotes e depend√™ncias facilita revis√£o e seguran√ßa; requisitos obrigat√≥rios de testes e crit√©rios de aceite refor√ßam qualidade; estrutura de pastas e nomenclatura padronizadas ajudam na consist√™ncia entre times.

**Sugest√£o:** Em ambientes com backlog externo (Jira, Azure DevOps), considerar campo opcional "ID externo" na story para link bidirecional.

**Conclus√£o:** Aprovado como guia universal de cria√ß√£o de hist√≥rias t√©cnicas com foco em rastreabilidade e qualidade.
